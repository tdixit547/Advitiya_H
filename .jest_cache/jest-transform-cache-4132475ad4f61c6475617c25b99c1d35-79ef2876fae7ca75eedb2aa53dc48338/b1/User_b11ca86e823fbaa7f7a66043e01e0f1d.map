{"file":"/Users/grover.heer/Documents/GitHub/Advitiya_H/src/models/User.ts","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,qDAAsD;AACtD,wDAA8B;AAiB9B,MAAM,UAAU,GAAG,IAAI,iBAAM,CAAQ;IACjC,OAAO,EAAE;QACL,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;QACd,MAAM,EAAE,IAAI;QACZ,KAAK,EAAE,IAAI;KACd;IACD,KAAK,EAAE;QACH,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;QACd,MAAM,EAAE,IAAI;QACZ,SAAS,EAAE,IAAI;QACf,IAAI,EAAE,IAAI;QACV,KAAK,EAAE,IAAI;KACd;IACD,aAAa,EAAE;QACX,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;QACd,MAAM,EAAE,KAAK,CAAE,sCAAsC;KACxD;IACD,IAAI,EAAE;QACF,IAAI,EAAE,MAAM;QACZ,IAAI,EAAE,CAAC,MAAM,EAAE,OAAO,CAAC;QACvB,OAAO,EAAE,MAAM;KAClB;IACD,IAAI,EAAE;QACF,IAAI,EAAE,MAAM;QACZ,IAAI,EAAE,IAAI;KACb;CACJ,EAAE;IACC,UAAU,EAAE,EAAE,SAAS,EAAE,YAAY,EAAE,SAAS,EAAE,YAAY,EAAE;CACnE,CAAC,CAAC;AAEH,uCAAuC;AACvC,UAAU,CAAC,OAAO,CAAC,eAAe,GAAG,KAAK,WAAW,QAAgB;IACjE,OAAO,kBAAM,CAAC,OAAO,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;AACxD,CAAC,CAAC;AAEF,iCAAiC;AACjC,UAAU,CAAC,OAAO,CAAC,YAAY,GAAG,KAAK,EAAE,QAAgB,EAAmB,EAAE;IAC1E,MAAM,IAAI,GAAG,MAAM,kBAAM,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;IACtC,OAAO,kBAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;AACvC,CAAC,CAAC;AAEF,+BAA+B;AAC/B,UAAU,CAAC,KAAK,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;AAEjB,QAAA,IAAI,GAAG,kBAAQ,CAAC,KAAK,CAAQ,MAAM,EAAE,UAAU,CAAC,CAAC;AAE9D;;GAEG;AACI,MAAM,YAAY,GAAG,KAAK,EAAE,QAAgB,EAAmB,EAAE;IACpE,MAAM,IAAI,GAAG,MAAM,kBAAM,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;IACtC,OAAO,kBAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;AACvC,CAAC,CAAC;AAHW,QAAA,YAAY,gBAGvB","names":[],"sources":["/Users/grover.heer/Documents/GitHub/Advitiya_H/src/models/User.ts"],"sourcesContent":["import mongoose, { Schema, Document } from 'mongoose';\nimport bcrypt from 'bcryptjs';\n\nexport type UserRole = 'user' | 'admin';\n\nexport interface IUser extends Document {\n    user_id: string;\n    email: string;\n    password_hash: string;\n    role: UserRole;\n    name?: string;\n    created_at: Date;\n    updated_at: Date;\n\n    // Instance methods\n    comparePassword(password: string): Promise<boolean>;\n}\n\nconst UserSchema = new Schema<IUser>({\n    user_id: {\n        type: String,\n        required: true,\n        unique: true,\n        index: true\n    },\n    email: {\n        type: String,\n        required: true,\n        unique: true,\n        lowercase: true,\n        trim: true,\n        index: true\n    },\n    password_hash: {\n        type: String,\n        required: true,\n        select: false  // Don't include by default in queries\n    },\n    role: {\n        type: String,\n        enum: ['user', 'admin'],\n        default: 'user'\n    },\n    name: {\n        type: String,\n        trim: true\n    },\n}, {\n    timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' }\n});\n\n// Instance method to compare passwords\nUserSchema.methods.comparePassword = async function (password: string): Promise<boolean> {\n    return bcrypt.compare(password, this.password_hash);\n};\n\n// Static method to hash password\nUserSchema.statics.hashPassword = async (password: string): Promise<string> => {\n    const salt = await bcrypt.genSalt(12);\n    return bcrypt.hash(password, salt);\n};\n\n// Index for role-based queries\nUserSchema.index({ role: 1 });\n\nexport const User = mongoose.model<IUser>('User', UserSchema);\n\n/**\n * Hash a password\n */\nexport const hashPassword = async (password: string): Promise<string> => {\n    const salt = await bcrypt.genSalt(12);\n    return bcrypt.hash(password, salt);\n};\n"],"version":3}