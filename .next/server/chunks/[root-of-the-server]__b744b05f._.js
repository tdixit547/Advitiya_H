module.exports=[93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},7155,e=>e.a(async(t,r)=>{try{let t=await e.y("pg-7688d3436e21ca14");e.n(t),r()}catch(e){r(e)}},!0),63497,e=>e.a(async(t,r)=>{try{var a=e.i(7155),n=t([a]);[a]=n.then?(await n)():n;let c=new a.Pool({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1},max:20,idleTimeoutMillis:3e4,connectionTimeoutMillis:2e3});async function i(e,t){Date.now();try{let r=await c.query(e,t);return Date.now(),r}catch(e){throw console.error("Database query error:",e),e}}async function s(e,t){return(await i(e,t)).rows[0]||null}async function o(e,t){return(await i(e,t)).rows}async function l(e,t){return(await i(e,t)).rows[0]}e.s(["insertOne",()=>l,"query",()=>i,"queryMany",()=>o,"queryOne",()=>s]),r()}catch(e){r(e)}},!1),95659,e=>e.a(async(t,r)=>{try{var a=e.i(15395),n=e.i(63497),i=t([n]);async function s(e){try{let{searchParams:t}=new URL(e.url),r=t.get("hub_id"),i=t.get("period")||"7d",s=7;"30d"===i&&(s=30),"90d"===i&&(s=90);let o=r?parseInt(r):1,l=await (0,n.queryOne)(`SELECT 
        COUNT(*) FILTER (WHERE event_type = 'VIEW') as total_views,
        COUNT(*) FILTER (WHERE event_type = 'CLICK') as total_clicks,
        COUNT(DISTINCT visitor_ip) as unique_visitors
       FROM events 
       WHERE hub_id = $1 
       AND created_at >= NOW() - INTERVAL '${s} days'`,[o]),c=await (0,n.queryMany)(`SELECT 
        l.id,
        l.title,
        COUNT(e.id) FILTER (WHERE e.event_type = 'CLICK') as clicks,
        CASE 
          WHEN COUNT(e.id) FILTER (WHERE e.event_type = 'VIEW') > 0 
          THEN ROUND(
            COUNT(e.id) FILTER (WHERE e.event_type = 'CLICK')::numeric / 
            COUNT(e.id) FILTER (WHERE e.event_type = 'VIEW')::numeric * 100, 1
          )
          ELSE 0
        END as ctr
       FROM links l
       LEFT JOIN events e ON e.link_id = l.id AND e.created_at >= NOW() - INTERVAL '${s} days'
       WHERE l.hub_id = $1
       GROUP BY l.id, l.title
       ORDER BY clicks DESC
       LIMIT 5`,[o]),u=await (0,n.queryMany)(`SELECT 
        DATE(created_at) as date,
        COUNT(*) FILTER (WHERE event_type = 'VIEW') as views,
        COUNT(*) FILTER (WHERE event_type = 'CLICK') as clicks
       FROM events
       WHERE hub_id = $1 AND created_at >= NOW() - INTERVAL '${s} days'
       GROUP BY DATE(created_at)
       ORDER BY date`,[o]),d=await (0,n.queryMany)(`SELECT 
        COALESCE(visitor_country, 'Unknown') as country,
        COUNT(*) as count
       FROM events
       WHERE hub_id = $1 AND created_at >= NOW() - INTERVAL '${s} days'
       GROUP BY visitor_country
       ORDER BY count DESC
       LIMIT 10`,[o]),p=await (0,n.queryMany)(`SELECT 
        COALESCE(visitor_device, 'unknown') as device,
        COUNT(*) as count
       FROM events
       WHERE hub_id = $1 AND created_at >= NOW() - INTERVAL '${s} days'
       GROUP BY visitor_device
       ORDER BY count DESC`,[o]),E={totalViews:Number(l?.total_views||0),totalClicks:Number(l?.total_clicks||0),uniqueVisitors:Number(l?.unique_visitors||0),topLinks:c.map(e=>({id:e.id,title:e.title,clicks:Number(e.clicks),ctr:Number(e.ctr)})),viewsByDay:u.map(e=>({date:String(e.date),views:Number(e.views),clicks:Number(e.clicks)})),viewsByCountry:d.map(e=>({country:e.country,count:Number(e.count)})),viewsByDevice:p.map(e=>({device:e.device,count:Number(e.count)}))};return a.NextResponse.json({success:!0,data:E})}catch(e){return console.error("[Analytics] Error fetching stats:",e),a.NextResponse.json({success:!1,error:"Failed to fetch analytics"},{status:500})}}[n]=i.then?(await i)():i,e.s(["GET",()=>s]),r()}catch(e){r(e)}},!1),8123,e=>e.a(async(t,r)=>{try{var a=e.i(76869),n=e.i(17846),i=e.i(12359),s=e.i(42464),o=e.i(43841),l=e.i(29728),c=e.i(61187),u=e.i(31746),d=e.i(59470),p=e.i(23254),E=e.i(29957),R=e.i(32402),y=e.i(58363),v=e.i(53385),h=e.i(66317),w=e.i(93695);e.i(35586);var C=e.i(78311),x=e.i(95659),N=t([x]);[x]=N.then?(await N)():N;let O=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/analytics/stats/route",pathname:"/api/analytics/stats",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/Documents/GitHub/Advitiya_H/src/app/api/analytics/stats/route.ts",nextConfigOutput:"",userland:x}),{workAsyncStorage:_,workUnitAsyncStorage:f,serverHooks:g}=O;function T(){return(0,i.patchFetch)({workAsyncStorage:_,workUnitAsyncStorage:f})}async function m(e,t,r){O.isDev&&(0,s.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let a="/api/analytics/stats/route";a=a.replace(/\/index$/,"")||"/";let i=await O.prepare(e,t,{srcPage:a,multiZoneDraftMode:!1});if(!i)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:x,params:N,nextConfig:T,parsedUrl:m,isDraftMode:_,prerenderManifest:f,routerServerContext:g,isOnDemandRevalidate:A,revalidateOnlyGenerated:b,resolvedPathname:I,clientReferenceManifest:D,serverActionsManifest:k}=i,L=(0,c.normalizeAppPath)(a),U=!!(f.dynamicRoutes[L]||f.routes[I]),S=async()=>((null==g?void 0:g.render404)?await g.render404(e,t,m,!1):t.end("This page could not be found"),null);if(U&&!_){let e=!!f.routes[I],t=f.dynamicRoutes[L];if(t&&!1===t.fallback&&!e){if(T.experimental.adapterPath)return await S();throw new w.NoFallbackError}}let H=null;!U||O.isDev||_||(H=I,H="/index"===H?"/":H);let q=!0===O.isDev||!U,P=U&&!q;k&&D&&(0,l.setManifestsSingleton)({page:a,clientReferenceManifest:D,serverActionsManifest:k});let M=e.method||"GET",W=(0,o.getTracer)(),F=W.getActiveScopeSpan(),j={params:N,prerenderManifest:f,renderOpts:{experimental:{authInterrupts:!!T.experimental.authInterrupts},cacheComponents:!!T.cacheComponents,supportsDynamicResponse:q,incrementalCache:(0,s.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:T.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a,n)=>O.onRequestError(e,t,a,n,g)},sharedContext:{buildId:x}},$=new u.NodeNextRequest(e),B=new u.NodeNextResponse(t),V=d.NextRequestAdapter.fromNodeNextRequest($,(0,d.signalFromNodeResponse)(t));try{let i=async e=>O.handle(V,j).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=W.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${M} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${M} ${a}`)}),l=!!(0,s.getRequestMeta)(e,"minimalMode"),c=async s=>{var o,c;let u=async({previousCacheEntry:n})=>{try{if(!l&&A&&b&&!n)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let a=await i(s);e.fetchMetrics=j.renderOpts.fetchMetrics;let o=j.renderOpts.pendingWaitUntil;o&&r.waitUntil&&(r.waitUntil(o),o=void 0);let c=j.renderOpts.collectedTags;if(!U)return await (0,R.sendResponse)($,B,a,j.renderOpts.pendingWaitUntil),null;{let e=await a.blob(),t=(0,y.toNodeOutgoingHttpHeaders)(a.headers);c&&(t[h.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==j.renderOpts.collectedRevalidate&&!(j.renderOpts.collectedRevalidate>=h.INFINITE_CACHE)&&j.renderOpts.collectedRevalidate,n=void 0===j.renderOpts.collectedExpire||j.renderOpts.collectedExpire>=h.INFINITE_CACHE?void 0:j.renderOpts.collectedExpire;return{value:{kind:C.CachedRouteKind.APP_ROUTE,status:a.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==n?void 0:n.isStale)&&await O.onRequestError(e,t,{routerKind:"App Router",routePath:a,routeType:"route",revalidateReason:(0,E.getRevalidateReason)({isStaticGeneration:P,isOnDemandRevalidate:A})},!1,g),t}},d=await O.handleResponse({req:e,nextConfig:T,cacheKey:H,routeKind:n.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:f,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:b,responseGenerator:u,waitUntil:r.waitUntil,isMinimalMode:l});if(!U)return null;if((null==d||null==(o=d.value)?void 0:o.kind)!==C.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(c=d.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});l||t.setHeader("x-nextjs-cache",A?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),_&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,y.fromNodeOutgoingHttpHeaders)(d.value.headers);return l&&U||p.delete(h.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,v.getCacheControlHeader)(d.cacheControl)),await (0,R.sendResponse)($,B,new Response(d.value.body,{headers:p,status:d.value.status||200})),null};F?await c(F):await W.withPropagatedContext(e.headers,()=>W.trace(p.BaseServerSpan.handleRequest,{spanName:`${M} ${a}`,kind:o.SpanKind.SERVER,attributes:{"http.method":M,"http.target":e.url}},c))}catch(t){if(t instanceof w.NoFallbackError||await O.onRequestError(e,t,{routerKind:"App Router",routePath:L,routeType:"route",revalidateReason:(0,E.getRevalidateReason)({isStaticGeneration:P,isOnDemandRevalidate:A})},!1,g),U)throw t;return await (0,R.sendResponse)($,B,new Response(null,{status:500})),null}}e.s(["handler",()=>m,"patchFetch",()=>T,"routeModule",()=>O,"serverHooks",()=>g,"workAsyncStorage",()=>_,"workUnitAsyncStorage",()=>f]),r()}catch(e){r(e)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__b744b05f._.js.map